<?php
require_once("config.php");
require_once("UserData.php");

/**
 * Class for validating content
 */
class Validation{


	public function malwareName($string){
		if ($string == "" || preg_match("/[ *]/", $string)){
		  return "no malware name provided<br>";

		}elseif (preg_match("/[^A-Za-z]/", $string)) {
		  return "not only english letters for the name of the malware were used<br>";
		}

		return true;
	}

	public function validateUser($name, $psw){
		$db = new Database();
		$tableUsers = new UserData();

		if(empty($name)||empty($psw)){
			return false;
		}

		$un_temp = $this->mysql_entities_fix_string($db->conn, $name);
		$pw_temp = $this->mysql_entities_fix_string($db->conn, $psw);

		return $tableUsers->validateLogin($un_temp, $pw_temp);
	}

 	private function mysql_entities_fix_string($connection, $string){
		return htmlentities($this->mysql_fix_string($connection, $string));
	}

	private function mysql_fix_string($connection, $string){

		if (get_magic_quotes_gpc()) $string = stripslashes($string);
		return $connection->real_escape_string($string);
	}


}

?>
