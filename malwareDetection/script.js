
function showHide() {
    var x = document.getElementById("inVisible")
    if (x.style.display === "none") {
        x.style.display = "block"
    } else {
        x.style.display = "none"
    }
}

function validate(form) {
		fail =  validateName(form.malwarename.value, "forname")
		fail += validateName(form.surname.value, "surname")
		fail += validateUsername(form.username.value)
		fail += validatePassword(form.password.value)
		fail += validateAge(form.age.value)
		fail += validateEmail(form.email.value)

		if (fail == "") return true;
		else { alert(fail); return false; }
}

function validateUsername(field){
	if (field == "") return "No Username was entered.\n"
	else if (field.length < 8)
		return "Usernames must be at least 8 characters.\n"
	else if (/[^a-zA-Z0-9_-]/.test(field))
		return "Only a-z, A-Z, 0-9, - and _ allowed in Usernames.\n"
	return ""
}


function validateName(field, atribute){
	fail = (field == "") ? atribute+" missing.\n" : ""
	fail += (/[^a-zA-Z]/.test(field)) ? atribute+" should only contain the alphabet.\n" : ""
	return fail
}

function validatePassword(field){
	if (field == "") return "No Password was entered.\n"
	else if (field.length < 6)
		return "Passwords must be at least 6 characters.\n"
	else if (!/[a-z]/.test(field) || ! /[A-Z]/.test(field) ||!/[0-9]/.test(field))
		return "Passwords require one each of a-z, A-Z and 0-9.\n"
	return ""
}

function validateAge(field){
	if (field == "") return "No Age was entered.\n"
		else if (field < 18 || field > 110)
		return "Age must be between 18 and 110.\n"
	return ""
}


function validateEmail(field){
	if (field == "") return "No Email was entered.\n"
	else if (!((field.indexOf(".") > 0) && (field.indexOf("@") > 0)) || /[^a-zA-Z0-9.@_-]/.test(field))
		return "The Email address is invalid.\n"
	return ""
}


function validateMalware(form){
	fail = validateMalwareName(form.malwarename.value)
	fail += validateMalwareFile(form.filename.value)

	if (fail == "") return true;
	else { alert(fail); return false; }

}

function validateMalwareName(name){

	if (name == ""||/[ *]/.test(name)){
		return "please insert a name of the malware"

	}else if (/[^A-Za-z]/.test(name)){
		return "please use only english letters for the name of the malware"
	}

	return ""
}

function validateMalwareFile(file){

	if (file == ""){
		return "please insert a file"

	}

	return ""
}


function hashPwd(form){
	pwd = form.pwd.value
	form.password.value = getHash(pwd)

}

function getHash(str) {
    p1 = 2654435761
    p2 = 1597334677
    h1 = 0xdeadbeef | 0
    h2 = 0x41c6ce57 | 0

    for (i = 0; i < str.length; i++)
        ch = str.charCodeAt(i), h1 = Math.imul(h1 + ch, p1), h2 = Math.imul(h2 + ch, p2);
    h1 = Math.imul(h1 ^ h1 >>> 16, p2), h2 = Math.imul(h2 ^ h2 >>> 15, p1);
    return (h2 & 2097151) * 4294967296 + h1;
}




