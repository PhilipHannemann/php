<?php

require_once("Website.php");
require_once("FileHandler.php");
require_once("Malware.php");
require_once("Validation.php");
require_once("Credentials.php");


$website = new Website();
$tableMalware = new Malware();
$credentials = new Credentials();
$validate = new Validation();

$isLoggedIn = $credentials->isLoggedIn();


if ($isLoggedIn === true){

	$website->showFileInput($credentials->getUserName());

}else{
	
	$website->showFileInput("");
}



$file = new FileHandler($_FILES);


if ($file->exists()){

	$file->open();

	$fileSignature = $file->getSignature();

	$name = $_POST["malwarename"];

	if($isLoggedIn === true){
		$fail = $validate->malwareName($name);

		if($fail !== true){
			echo $fail;
		}else{
			$tableMalware->insert($name, $fileSignature);
		}
		
	}else{
		$tableMalware->search($fileSignature);
	}

}





?>